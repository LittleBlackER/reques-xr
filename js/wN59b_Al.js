import{c as g,r as ue,a as C}from"./H-cN399H.js";import{r as oe,b as le,c as ae}from"./CZq0xcQz.js";import{b as se,a as de}from"./CTy_bxvY.js";var M,N;function ce(){if(N)return M;N=1,M=p;function p(c,l){if(o("noDeprecation"))return c;var a=!1;function v(){if(!a){if(o("throwDeprecation"))throw new Error(l);o("traceDeprecation")?console.trace(l):console.warn(l),a=!0}return c.apply(this,arguments)}return v}function o(c){try{if(!g.localStorage)return!1}catch{return!1}var l=g.localStorage[c];return l==null?!1:String(l).toLowerCase()==="true"}return M}var T,O;function be(){if(O)return T;O=1,T=f;function p(r){var e=this;this.next=null,this.entry=null,this.finish=function(){ie(e,r)}}var o;f.WritableState=w;var c={deprecate:ce()},l=oe(),a=se().Buffer,v=(typeof g<"u"?g:typeof window<"u"?window:typeof self<"u"?self:{}).Uint8Array||function(){};function x(r){return a.from(r)}function I(r){return a.isBuffer(r)||r instanceof v}var S=ae(),L=le(),P=L.getHighWaterMark,s=de().codes,k=s.ERR_INVALID_ARG_TYPE,W=s.ERR_METHOD_NOT_IMPLEMENTED,j=s.ERR_MULTIPLE_CALLBACK,U=s.ERR_STREAM_CANNOT_PIPE,F=s.ERR_STREAM_DESTROYED,m=s.ERR_STREAM_NULL_VALUES,H=s.ERR_STREAM_WRITE_AFTER_END,G=s.ERR_UNKNOWN_ENCODING,h=S.errorOrDestroy;ue()(f,l);function K(){}function w(r,e,t){o=o||C(),r=r||{},typeof t!="boolean"&&(t=e instanceof o),this.objectMode=!!r.objectMode,t&&(this.objectMode=this.objectMode||!!r.writableObjectMode),this.highWaterMark=P(this,r,"writableHighWaterMark",t),this.finalCalled=!1,this.needDrain=!1,this.ending=!1,this.ended=!1,this.finished=!1,this.destroyed=!1;var i=r.decodeStrings===!1;this.decodeStrings=!i,this.defaultEncoding=r.defaultEncoding||"utf8",this.length=0,this.writing=!1,this.corked=0,this.sync=!0,this.bufferProcessing=!1,this.onwrite=function(n){X(e,n)},this.writecb=null,this.writelen=0,this.bufferedRequest=null,this.lastBufferedRequest=null,this.pendingcb=0,this.prefinished=!1,this.errorEmitted=!1,this.emitClose=r.emitClose!==!1,this.autoDestroy=!!r.autoDestroy,this.bufferedRequestCount=0,this.corkedRequestsFree=new p(this)}w.prototype.getBuffer=function(){for(var e=this.bufferedRequest,t=[];e;)t.push(e),e=e.next;return t},function(){try{Object.defineProperty(w.prototype,"buffer",{get:c.deprecate(function(){return this.getBuffer()},"_writableState.buffer is deprecated. Use _writableState.getBuffer instead.","DEP0003")})}catch{}}();var R;typeof Symbol=="function"&&Symbol.hasInstance&&typeof Function.prototype[Symbol.hasInstance]=="function"?(R=Function.prototype[Symbol.hasInstance],Object.defineProperty(f,Symbol.hasInstance,{value:function(e){return R.call(this,e)?!0:this!==f?!1:e&&e._writableState instanceof w}})):R=function(e){return e instanceof this};function f(r){o=o||C();var e=this instanceof o;if(!e&&!R.call(f,this))return new f(r);this._writableState=new w(r,this,e),this.writable=!0,r&&(typeof r.write=="function"&&(this._write=r.write),typeof r.writev=="function"&&(this._writev=r.writev),typeof r.destroy=="function"&&(this._destroy=r.destroy),typeof r.final=="function"&&(this._final=r.final)),l.call(this)}f.prototype.pipe=function(){h(this,new U)};function V(r,e){var t=new H;h(r,t),process.nextTick(e,t)}function Y(r,e,t,i){var n;return t===null?n=new m:typeof t!="string"&&!e.objectMode&&(n=new k("chunk",["string","Buffer"],t)),n?(h(r,n),process.nextTick(i,n),!1):!0}f.prototype.write=function(r,e,t){var i=this._writableState,n=!1,u=!i.objectMode&&I(r);return u&&!a.isBuffer(r)&&(r=x(r)),typeof e=="function"&&(t=e,e=null),u?e="buffer":e||(e=i.defaultEncoding),typeof t!="function"&&(t=K),i.ending?V(this,t):(u||Y(this,i,r,t))&&(i.pendingcb++,n=z(this,i,u,r,e,t)),n},f.prototype.cork=function(){this._writableState.corked++},f.prototype.uncork=function(){var r=this._writableState;r.corked&&(r.corked--,!r.writing&&!r.corked&&!r.bufferProcessing&&r.bufferedRequest&&B(this,r))},f.prototype.setDefaultEncoding=function(e){if(typeof e=="string"&&(e=e.toLowerCase()),!(["hex","utf8","utf-8","ascii","binary","base64","ucs2","ucs-2","utf16le","utf-16le","raw"].indexOf((e+"").toLowerCase())>-1))throw new G(e);return this._writableState.defaultEncoding=e,this},Object.defineProperty(f.prototype,"writableBuffer",{enumerable:!1,get:function(){return this._writableState&&this._writableState.getBuffer()}});function $(r,e,t){return!r.objectMode&&r.decodeStrings!==!1&&typeof e=="string"&&(e=a.from(e,t)),e}Object.defineProperty(f.prototype,"writableHighWaterMark",{enumerable:!1,get:function(){return this._writableState.highWaterMark}});function z(r,e,t,i,n,u){if(!t){var d=$(e,i,n);i!==d&&(t=!0,n="buffer",i=d)}var b=e.objectMode?1:i.length;e.length+=b;var y=e.length<e.highWaterMark;if(y||(e.needDrain=!0),e.writing||e.corked){var E=e.lastBufferedRequest;e.lastBufferedRequest={chunk:i,encoding:n,isBuf:t,callback:u,next:null},E?E.next=e.lastBufferedRequest:e.bufferedRequest=e.lastBufferedRequest,e.bufferedRequestCount+=1}else q(r,e,!1,b,i,n,u);return y}function q(r,e,t,i,n,u,d){e.writelen=i,e.writecb=d,e.writing=!0,e.sync=!0,e.destroyed?e.onwrite(new F("write")):t?r._writev(n,e.onwrite):r._write(n,u,e.onwrite),e.sync=!1}function J(r,e,t,i,n){--e.pendingcb,t?(process.nextTick(n,i),process.nextTick(_,r,e),r._writableState.errorEmitted=!0,h(r,i)):(n(i),r._writableState.errorEmitted=!0,h(r,i),_(r,e))}function Q(r){r.writing=!1,r.writecb=null,r.length-=r.writelen,r.writelen=0}function X(r,e){var t=r._writableState,i=t.sync,n=t.writecb;if(typeof n!="function")throw new j;if(Q(t),e)J(r,t,i,e,n);else{var u=A(t)||r.destroyed;!u&&!t.corked&&!t.bufferProcessing&&t.bufferedRequest&&B(r,t),i?process.nextTick(D,r,t,u,n):D(r,t,u,n)}}function D(r,e,t,i){t||Z(r,e),e.pendingcb--,i(),_(r,e)}function Z(r,e){e.length===0&&e.needDrain&&(e.needDrain=!1,r.emit("drain"))}function B(r,e){e.bufferProcessing=!0;var t=e.bufferedRequest;if(r._writev&&t&&t.next){var i=e.bufferedRequestCount,n=new Array(i),u=e.corkedRequestsFree;u.entry=t;for(var d=0,b=!0;t;)n[d]=t,t.isBuf||(b=!1),t=t.next,d+=1;n.allBuffers=b,q(r,e,!0,e.length,n,"",u.finish),e.pendingcb++,e.lastBufferedRequest=null,u.next?(e.corkedRequestsFree=u.next,u.next=null):e.corkedRequestsFree=new p(e),e.bufferedRequestCount=0}else{for(;t;){var y=t.chunk,E=t.encoding,ne=t.callback,fe=e.objectMode?1:y.length;if(q(r,e,!1,fe,y,E,ne),t=t.next,e.bufferedRequestCount--,e.writing)break}t===null&&(e.lastBufferedRequest=null)}e.bufferedRequest=t,e.bufferProcessing=!1}f.prototype._write=function(r,e,t){t(new W("_write()"))},f.prototype._writev=null,f.prototype.end=function(r,e,t){var i=this._writableState;return typeof r=="function"?(t=r,r=null,e=null):typeof e=="function"&&(t=e,e=null),r!=null&&this.write(r,e),i.corked&&(i.corked=1,this.uncork()),i.ending||te(this,i,t),this},Object.defineProperty(f.prototype,"writableLength",{enumerable:!1,get:function(){return this._writableState.length}});function A(r){return r.ending&&r.length===0&&r.bufferedRequest===null&&!r.finished&&!r.writing}function ee(r,e){r._final(function(t){e.pendingcb--,t&&h(r,t),e.prefinished=!0,r.emit("prefinish"),_(r,e)})}function re(r,e){!e.prefinished&&!e.finalCalled&&(typeof r._final=="function"&&!e.destroyed?(e.pendingcb++,e.finalCalled=!0,process.nextTick(ee,r,e)):(e.prefinished=!0,r.emit("prefinish")))}function _(r,e){var t=A(e);if(t&&(re(r,e),e.pendingcb===0&&(e.finished=!0,r.emit("finish"),e.autoDestroy))){var i=r._readableState;(!i||i.autoDestroy&&i.endEmitted)&&r.destroy()}return t}function te(r,e,t){e.ending=!0,_(r,e),t&&(e.finished?process.nextTick(t):r.once("finish",t)),e.ended=!0,r.writable=!1}function ie(r,e,t){var i=r.entry;for(r.entry=null;i;){var n=i.callback;e.pendingcb--,n(t),i=i.next}e.corkedRequestsFree.next=r}return Object.defineProperty(f.prototype,"destroyed",{enumerable:!1,get:function(){return this._writableState===void 0?!1:this._writableState.destroyed},set:function(e){this._writableState&&(this._writableState.destroyed=e)}}),f.prototype.destroy=S.destroy,f.prototype._undestroy=S.undestroy,f.prototype._destroy=function(r,e){e(r)},T}export{be as r};
